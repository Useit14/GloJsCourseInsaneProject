(()=>{"use strict";const e=(e,t,r="portfolio-item-active",o,l,a,s,n="slider-counter-content__current",i="slider-counter-content__total",c,u,p=!0)=>{const d=document.querySelector(`.${e}`);let g=document.querySelectorAll(`.${t}`);const m=d.querySelector(`.${n}`),v=d.querySelector(`.${i}`),h=document.querySelector(`#${l}`),y=document.querySelector(`#${a}`),f=document.querySelector(".popup-portfolio").querySelector(".close");let _,b=0,L="right";const S=(e,r,o)=>{c?(e[e.length-1].after(e[0]),g=document.querySelectorAll(`.${t}`)):e[r].classList.remove(o)},w=(e,r,o)=>{c?(e[0].before(e[e.length-1]),g=document.querySelectorAll(`.${t}`)):(e[r].classList.add(o),n&&(m.textContent=r+1))},k=()=>{(c&&"left"===L||!c)&&S(g,b,r),(c&&"right"===L||!c)&&b++,c&&"left"===L&&b--,!c&&b>=g.length?b=0:b>=g.length?(L="left",h.classList.toggle("none"),y.classList.toggle("none")):b<0&&(L="right",h.classList.toggle("none"),y.classList.toggle("none")),(c&&"right"===L||!c)&&w(g,b,r)},E=(e=1500)=>{p&&(_=setInterval(k,e))};var q;return u&&d.addEventListener("click",(e=>{e.preventDefault(),e.target.closest(`.${o}`)&&(!c&&S(g,b,r),e.target.closest(`#${a}`)?(b++,c&&w(g,b,r)):e.target.closest(`#${l}`)&&(b--,c&&S(g,b,r)),!c&&b>=g.length?b=0:b>=g.length?(L="left",h.classList.toggle("none"),y.classList.toggle("none")):b<=0&&(L="right",h.classList.toggle("none"),y.classList.toggle("none")),!c&&w(g,b,r))})),d.addEventListener("mouseenter",(e=>{e.target.matches(`.${o}`)&&clearInterval(_)}),!0),d.addEventListener("mouseleave",(e=>{e.target.matches(` .${o}`)&&E(2e3)}),!0),i&&(v.textContent=g.length),"number"==typeof s&&(q=s,g.forEach(((e,t)=>{e.classList.add("none"),q===t&&(e.classList.add(r),b=q)}))),s&&f.addEventListener("click",(()=>_)),E(2e3),_},t=(t,r,{isCarousel:o="",isInitActiveSlide:l="",classSlides:a="",classSlider:s="",classActiveSlides:n="",portfolioBtn:i="",classControlLeft:c="",classControlRight:u="",classCounter:p="",classCounterTotal:d="",isWithChangeNode:g,isControl:m,isAuto:v},h,y)=>{const f=document.querySelector(`.${t}`),_=document.querySelectorAll(`.${r}`),b=f.querySelector(".close ");let L;r?_.forEach((t=>{t.addEventListener("click",(t=>{o?(f.style.visibility="visible",L=e(s,a,n,i,c,u,l&&(e=>{const t=e.target.querySelector("img");return parseInt(t.alt[t.alt.search(/[0-9]/)])-1})(t),p,d,g,m,v)):f.style.visibility="visible"}))})):h?(f.getBoundingClientRect().top<0&&f.classList.add("formula-item-popup-bottom"),f.style.opacity=1,f.style.visibility="visible"):f.style.visibility="visible",b&&b.addEventListener("click",(()=>{clearInterval(L),f.style.visibility="hidden"}))},r=(e,t="input")=>{const r=document.getElementById(e),o=r.querySelectorAll("input[name='name']"),l=r.querySelectorAll("input[name='email']"),a=r.querySelectorAll("input[name='phone']"),s=r.querySelectorAll("input[name='message']"),n=r.querySelectorAll("input[type='checkbox']");let i=!0,c=[],u=["+","7","(","_","_","_",")","_","_","_","-","_","_","-","_","_"];const p=e=>{e.target.value=e.target.value.replace(/[\s]{2}/gi," "),e.target.value=e.target.value.replace(/^[\s\-]|[\s\-]$/gi,""),e.target.matches('input[type="text"]')&&(e.target.value=e.target.value.replace(/([а-я]?)([а-я]+$)/gi,((e,t,r)=>t.toString().toUpperCase()+r.toString().toLowerCase())))};return o.forEach((e=>{e.addEventListener("input",(e=>{if("input"===t)return p(e),void(e.target.value=e.target.value.replace(/[^а-я\-\s]/gi,""))})),/[а-я\-\s]{2,}/gi.test(e.value)&&""!==e.value||(e.value="",c.push("Некорректное имя"),i=!1)})),l.forEach((e=>{e.addEventListener("input",(e=>{if("input"===t)return p(e),void(e.target.value=e.target.value.replace(/[^a-z\-\_\.\!\~\*\'@0-9]/gi,""))})),e.value.match(/[a-z\-\_\.\!\~\*\'0-9]+[@][a-z\-\_\!\~\*\'0-9]+[\.][a-z\-\_\!\~\*\']+/gi)&&""!==e.value||(e.value="",c.push("Некорректный почтовый ящик"),i=!1)})),a.forEach((e=>{e.addEventListener("keydown",(e=>{e.preventDefault(),(e=>{let t=!0;if(/\d/gi.test(parseInt(e.key)))u.forEach(((r,o)=>{"_"!==r&&""!==r||!t||(u[o]=e.key,t=!1)}));else if("Backspace"===e.key)if("_"===u[e.target.selectionStart-1]){for(let e=u.length-1;e>0;e--)if(/\d/gi.test(u[e])){u[e]="_";break}}else/\d/gi.test(u[e.target.selectionStart-1])&&(u[e.target.selectionStart-1]="_");e.target.value=u.join("")})(e)})),e.addEventListener("blur",(e=>{p(e)})),e.value.match(/\+7\(\d{3}\)\d{3}\-\d{2}\-\d{2}/gi)&&""!==e.value||(e.value="",c.push("Некорректный номер телефона"),i=!1)})),s.forEach((e=>{e.addEventListener("input",(e=>{e.target.value=e.target.value.replace(/[^а-я\s0-9\.\,\!\?]/gi,""),"input"!==t||p(e)})),e.value.match(/[а-я\s0-9\.\,\!\?]+/gi)&&""!==e.value||(e.value="",c.push("Некорректное сообщение"),i=!1)})),n.forEach((e=>{e.checked||(e.value="",c.push("Согласитесь с политикой конфиденциальности"),i=!1)})),{response:i,message:c}},o=({formId:e,someElem:o=[]})=>{const l=document.querySelector(`#${e}`),a=l.querySelector(".button"),s=document.querySelector(".popup-error__descr");try{if(!l)throw new Error("Верните форму на место, пожалуйста");a.addEventListener("click",(a=>{a.preventDefault(),(()=>{const a=l.querySelectorAll("input"),n=new FormData(l),i={};n.forEach(((e,t)=>{i[t]=e})),o.length>0&&o.forEach((e=>{const t=document.getElementById(e.id);"block"===e.type?i[e.id]=t.textContent:"input"===e.type?i[e.id]=t.value:"checkbox"===e.type&&(i[e.id]=t.checked)}));const{response:c,message:u}=r(e,"change");c?(async e=>await fetch("https://jsonplaceholder.typicode.com/posts",{method:"POST",body:JSON.stringify(e),headers:{"Content-type":"application/json"}}).then((e=>e.json())))(i).then((e=>{a.forEach((e=>{e.value="",t("popup-thank",null,{})}))})).catch((e=>{s.textContent=u.join(". "),t("popup-error",null,{})})):(s.textContent=u.join(". "),t("popup-error",null,{}))})()}))}catch(e){console.log(e)}};var l;window.userService=new class{async getData(e,t){return await fetch(`${e}/${t?.id?t?.id:""}${t?.filter?"?"+t?.filter+"=true":""}${t?.sort?"?_sort="+t?.sort+"&_order="+t?.order:""}${t?.search?"?name_like="+t?.search:""}`).then((e=>{console.log(e),e.json()})).catch((e=>console.log(e)))}async sendData(e,t){return await fetch(`${e}/${t.id?t.id:""}`,{method:t.method,headers:{"Content-Type":"application/json"},body:JSON.stringify(t.body)}).then((e=>e.json()))}},((e,t,r={changeLogo:!0})=>{const o=document.querySelector(`.${e}`),l=document.querySelector(`.${t}`);let a=!0;o.addEventListener("click",(()=>{const e=(e=>{const t=document.querySelector(`.${e}`).children;let r;for(let e=0;e<t.length;e++)if(t[e].classList.entries("hidden"))return r=t[e],r})(`${t}`);(({timing:e,draw:t,duration:r},o)=>{let l=performance.now();requestAnimationFrame((function o(a){let s=(a-l)/r;s>1&&(s=1);let n=e(s);t(n),s<1&&requestAnimationFrame(o)}))})(a?{duration:100,timing:e=>e,draw(t){l.style.top=`${Math.trunc(25*t)}px`,e.style.opacity=t}}:{duration:100,timing:e=>e,draw(t){l.style.top=25-Math.trunc(25*t)+"px",e.style.opacity=1-t}}),r.changeLogo&&((()=>{const e=o.querySelector("img");e&&(/down/.test(e.src)?e.src="./images/header/arrow-up.svg":e.src="./images/header/arrow-down.svg")})(),a=!a)}))})("header-contacts__arrow","header-contacts__phone-number-accord"),(()=>{const e=document.querySelector(".menu__icon"),t=document.querySelector(".popup-dialog-menu"),r=document.querySelector(".button-footer a"),o=(e,t)=>{if(t.target.matches(".link-list .menu-link"))return;t.preventDefault();const r=e.hash;document.querySelector(`${r}`).scrollIntoView({block:"start",behavior:"smooth"})},l=e=>{e.target.classList.contains("menu__icon")?t.classList.toggle("popup-dialog-menu-active"):e.target.classList.contains("close-menu")?(e.preventDefault(),t.classList.remove("popup-dialog-menu-active")):e.target.matches(".popup-dialog-menu-active a")&&(e.preventDefault(),t.classList.toggle("popup-dialog-menu-active"),o(e.target,e))};t.addEventListener("click",(e=>{l(e)})),e.addEventListener("click",(e=>{l(e)})),r.addEventListener("click",(e=>o(r,e)))})(),t("popup-repair-types","link-list a",{isCarousel:!1}),t("popup-privacy","link-privacy",{isCarousel:!1}),t("popup-consultation","button_wide",{isCarousel:!1}),t("popup-transparency","transparency-item__img",{isCarousel:!0,isInitActiveSlide:!0,classSlides:"popup-transparency-slider__slide",classSlider:"popup-transparency",classActiveSlides:"active",classControlLeft:"transparency_left",classControlRight:"transparency_right",portfolioBtn:"popup-arrow ",classCounter:"slider-counter-content__current",classCounterTotal:"slider-counter-content__total",isWithChangeNode:!1,isControl:!0,isAuto:!1}),r("feedback1"),r("feedback2"),r("feedback3"),r("feedback4"),r("feedback5"),r("feedback6"),o({formId:"feedback1",someElem:[{type:"checkbox",id:"checkbox1"}]}),o({formId:"feedback2",someElem:[{type:"checkbox",id:"checkbox2"}]}),o({formId:"feedback3",someElem:[{type:"checkbox",id:"checkbox3"}]}),o({formId:"feedback4",someElem:[{type:"checkbox",id:"checkbox4"}]}),o({formId:"feedback5",someElem:[{type:"checkbox",id:"checkbox5"}]}),o({formId:"feedback6",someElem:[{type:"checkbox",id:"checkbox6"}]}),l="accordion",document.querySelector(`.${l}`).addEventListener("click",(e=>{e.target.classList.contains("title_block")&&e.target.classList.toggle("msg-active")})),e("reviews-slider-wrap","reviews-slider__slide","acitve-flex","slider-arrow ","reviews-arrow_left","reviews-arrow_right",null,null,null,!1,!0),(()=>{const t=document.querySelector(".nav-list-repair"),r=document.querySelectorAll(".repair-types-slider .type");let o,l=0;t.addEventListener("click",(a=>{const s=parseInt(a.target.classList[2][a.target.classList[2].search(/(\d)/gi)])-1;clearInterval(l),(e=>{t.querySelectorAll("button").forEach((e=>{e.classList.remove("active")})),r.forEach(((t,r)=>{r===e?(t.classList.add("active"),o=t.children[0].classList[0]):t.classList.entries("active")&&(t.classList.remove("active"),t.classList.add("none"))}))})(s),a.target.classList.add("active"),l=e("repair-types-slider-wrap",`${o}`,"active","slider-arrow ","repair-types-arrow_left","repair-types-arrow_right",s,"slider-counter-content__current","slider-counter-content__total",!1,!1)})),l=e("repair-types-slider-wrap","repair-types1-slider__slide","active","slider-arrow ","repair-types-arrow_left","repair-types-arrow_right",0,"slider-counter-content__current","slider-counter-content__total",!1,!1),window.addEventListener("resize",(()=>{screen.width<=1024?l=e("nav-wrap-repair","repair-types-nav__item","active","nav-arrow ","nav-arrow-repair-left_base","nav-arrow-repair-right_base",0,null,null,!1,!0,!1):document.querySelectorAll(".repair-types-nav__item").forEach(((e,t)=>{e.classList.remove("none"),e.classList.remove("active"),0===t&&e.classList.add("active")}))}))})(),(()=>{let e;document.querySelectorAll("#formula .formula-item__icon").forEach((r=>{r.addEventListener("mouseover",(r=>(r=>{r.target.matches(".formula-item__icon-inner-text")&&(e=r.target.textContent,t(`formula-item-popup-${e}`,void 0,{isCarousel:!1},!0,r.target))})(r))),r.addEventListener("mouseout",(t=>{const r=document.querySelector(`.formula-item-popup-${e}`);r.classList.remove("formula-item-popup-bottom"),r.style.visibility="hidden"}))}))})(),(()=>{const r=document.querySelectorAll(".portfolio-slider__slide"),o=document.querySelector(".popup-portfolio").querySelector(".close ");let l;const a=e=>{const t=e.target.querySelector("img");return parseInt(t.alt[t.alt.search(/[0-9]/)])-1};e("portfolio-slider","portfolio-slider__slide","active","slider-arrow ","portfolio-arrow_left","portfolio-arrow_right",null,null,null,!0,!1),r.forEach((r=>{r.addEventListener("click",(r=>{t("popup-portfolio",null,{isCarousel:!1}),l=e("popup-dialog-portfolio","popup-portfolio-slider__slide","active","popup-arrow","popup_portfolio_left","popup_portfolio_right",a(r),"slider-counter-content__current","slider-counter-content__total",!1,!1,!0),e("popup-dialog-portfolio","popup-portfolio-text","active","popup-arrow","popup_portfolio_left","popup_portfolio_right",a(r),null,null,!1,!1,!0)}))})),o&&o.addEventListener("click",(()=>{clearInterval(l)}))})(),screen.width<=575&&e("transparency-slider-wrap","transparency-item","acitve-flex","slider-arrow ","transparency-arrow_left","transparency-arrow_right",0,null,null,!1,!0,!0),(()=>{let e;const t=document.querySelectorAll(".nav-list.nav-list-popup-repair .button_o"),r=(e,t)=>e.filter((e=>{e.type})),o=e=>{const t=document.querySelector(".popup-repair-types-content__head-title"),r=document.querySelector(".popup-repair-types-content-table__list");t.textContent=e[0].type;const o=r.querySelector("tbody");o.innerHTML="",e.forEach((e=>{o.innerHTML+=`\n        <tr class="mobile-row showHide">\n                      <td class="repair-types-name">\n                        ${e.name}\n                      </td>\n                      <td class="mobile-col-title tablet-hide desktop-hide">\n                        Ед.измерения\n                      </td>\n                      <td class="mobile-col-title tablet-hide desktop-hide">\n                        Цена за ед.\n                      </td>\n                      <td class="repair-types-value">${e.units}</sup></td>\n                      <td class="repair-types-value">${e.cost}</td>\n                    </tr>\n                    `}))};window.userService.getData("./db/db.json").then((t=>{e=t,o(r(t))})),t.forEach((t=>{t.addEventListener("click",(t=>{o(r(e,t.textContent))}))}))})()})();