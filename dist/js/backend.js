(()=>{"use strict";window.userService=new class{async getData(e,t){return await fetch(`${e}${t?"/":""}${t?.id?t?.id:""}${t?.filter?"?"+t?.filter+"=true":""}${t?.sort?"?_sort="+t?.sort+"&_order="+t?.order:""}${t?.search?"?name_like="+t?.search:""}`).then((e=>e.json())).catch((e=>console.log(e)))}async sendData(e,t){return await fetch(`${e}/${t.id?t.id:""}`,{method:t.method,headers:{"Content-Type":"application/json"},body:JSON.stringify(t.body)}).then((e=>e.json()))}},document.querySelector("form"),(()=>{let e;const t=document.querySelector("form"),a=document.querySelector(".text-warning"),r=()=>{const{response:r,message:n}=((e,t="input")=>{const a=document.getElementById(e),r=a.querySelectorAll("input[name='name']"),n=a.querySelectorAll("input[name='email']"),l=a.querySelectorAll("input[name='phone']"),s=a.querySelectorAll("input[name='message']"),u=a.querySelectorAll("input[type='checkbox']");let i=!0,o=[],c=["+","7","(","_","_","_",")","_","_","_","-","_","_","-","_","_"];const d=e=>{e.target.value=e.target.value.replace(/[\s]{2}/gi," "),e.target.value=e.target.value.replace(/^[\s\-]|[\s\-]$/gi,""),e.target.matches('input[type="text"]')&&(e.target.value=e.target.value.replace(/([а-я]?)([а-я]+$)/gi,((e,t,a)=>t.toString().toUpperCase()+a.toString().toLowerCase())))};return r.forEach((e=>{e.addEventListener("input",(e=>{if("input"===t)return d(e),void(e.target.value=e.target.value.replace(/[^а-я\-\s]/gi,""))})),/[а-я\-\s]{2,}/gi.test(e.value)&&""!==e.value||(e.value="",o.push("Некорректное имя"),i=!1)})),n.forEach((e=>{e.addEventListener("input",(e=>{if("input"===t)return d(e),void(e.target.value=e.target.value.replace(/[^a-z\-\_\.\!\~\*\'@0-9]/gi,""))})),e.value.match(/[a-z\-\_\.\!\~\*\'0-9]+[@][a-z\-\_\!\~\*\'0-9]+[\.][a-z\-\_\!\~\*\']+/gi)&&""!==e.value||(e.value="",o.push("Некорректный почтовый ящик"),i=!1)})),l.forEach((e=>{e.addEventListener("keydown",(e=>{e.preventDefault(),(e=>{let t=!0;if(/\d/gi.test(parseInt(e.key)))c.forEach(((a,r)=>{"_"!==a&&""!==a||!t||(c[r]=e.key,t=!1)}));else if("Backspace"===e.key)if("_"===c[e.target.selectionStart-1]){for(let e=c.length-1;e>0;e--)if(/\d/gi.test(c[e])){c[e]="_";break}}else/\d/gi.test(c[e.target.selectionStart-1])&&(c[e.target.selectionStart-1]="_");e.target.value=c.join("")})(e)})),e.addEventListener("blur",(e=>{d(e)})),e.value.match(/\+7\(\d{3}\)\d{3}\-\d{2}\-\d{2}/gi)&&""!==e.value||(e.value="",o.push("Некорректный номер телефона"),i=!1)})),s.forEach((e=>{e.addEventListener("input",(e=>{e.target.value=e.target.value.replace(/[^а-я\s0-9\.\,\!\?]/gi,""),"input"!==t||d(e)})),e.value.match(/[а-я\s0-9\.\,\!\?]+/gi)&&""!==e.value||(e.value="",o.push("Некорректное сообщение"),i=!1)})),u.forEach((e=>{e.checked||(e.value="",o.push("Согласитесь с политикой конфиденциальности"),i=!1)})),{response:i,message:o}})(formId,"change");if(r){window.userService.getData("db.users").then((t=>{e=t}));const a=new FormData(t),r={};a.forEach(((e,t)=>{r[t]=e})),"user"===e.login&&"12345678"===e.password&&console.log(r)}else a.style.opacity=1};t.addEventListener("submit",(e=>{e.preventDefault(),r()}))})()})();